---
id: deploy
sidebar_position: 4
---

# 发布
应用配置完成后，就可以开始我们的发布之旅了~

## 序言: 分支管理
我们的发布是基于分支发布的，所以应用应该有一套分支管理，不管是基于「TrunkBased」还是「GitFlow」，你都应该有一套自己的模式；并将「主干分支」保护起来，不允许开发直接修改主干分支，而是发布上线后才将上线代码合并到「主干分支」。

## 1. 新建开发分支 & 开发
首先，需要从「主干」新建一条「开发分支」，并在该分支上进行代码开发；开发完成后提交远程；
## 2. 新建发布
确认功能没问题且代码提交后，在应用「发布记录」页面 - 新建发布，选择需要发布的「代码分支」；
## 3. 发布配置
开始发布任务前，需要进行一些发布配置，这些发布配置是「插件」所需的，可以参考[进阶 - 配置](../advanced/config)进行默认配置；比如选择发布同步的「服务器」；

## 4. 开始发布
完成配置后，点击「发布」按钮，即可开始发布；

## 5. 发布过程 & 结果
开始发布后，「nidle 调度器」会依次执行各个插件，直到「全部完成」或「插件失败」结束；

如果「全部完成」，该环境「发布成功」，可以进入「下一个发布环境」；

如果「插件失败」，该环境「发布失败」，通过查看日志确认失败原因并进行相应调整后，可以「重新开始」发布；

## 其他
### 发布日志
nidle 基于 [pino](https://getpino.io/#/) 内置了日志支持，它对于构建部署流程的运行状况、问题排查等有非常重要的意义；

开发发布后，会实时反馈构建流程日志；

发布结束后，在详情中可以随时查看日志详情，用于问题定位；

### 记录集合
为了记录「每个环境每个构建部署流程」，每一个发布都是一条新的「发布记录」，同时为了便于查找同一「发布任务」的所有关联发布记录，我们在「发布记录」页面进行了聚合「记录集合」；

集合默认只展示「当前发布记录」，通过展开，可以查看其它相关联发布记录；

同时为了区分不同环境的发布记录，避免误操作，当前发布记录进入某个环境后，该「记录集合」会出现在对应的「环境Tab」下；

### 退出发布
当出现以下情况时，你可以选择退出发布：
1. 发布取消、代码有改动；
2. 其他发布优先，需要退出释放服务资源；
3. 发布配置有变动，重新加载最新发布配置；
